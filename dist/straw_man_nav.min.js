/*!
 *   straw_man_nav.js
 * See {@link https://github.com/dettalant/straw_man_nav}
 *
 * @author dettalant
 * @version v0.3.1
 * @license MIT License
 */
!function(){"use strict";function t(t){this.message=t,this.name="NavManagerError"}var i=null===window.ontouchstart,s=i?"touchend":"click",r="メニューを開く",c=function(){var t="http://www.w3.org/2000/svg",e=document.createElementNS(t,"svg");e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("class","svg_icon icon_menu"),e.setAttribute("role","img");var n=document.createElementNS(t,"title");n.textContent=r,e.appendChild(n);var o=document.createElementNS(t,"path");return o.setAttribute("class","svg_main_color"),o.setAttribute("d","M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"),e.appendChild(o),e},l="globalNavContainer",a="globalNav",d="global_nav_clip",p="is_close_global_nav",u="globalNavOpener",e="is_opened",n="is_visible";t.prototype.toString=function(){return this.name+": "+this.message};function v(){this.globalNavCloseElements=document.getElementsByClassName(p),this.states={isSwiping:!1,scrollY:0};var t=document.getElementById(l);if(null===t)throw new h("#"+l+"の取得ができませんでした");var e=document.getElementById(a);if(null===e)throw new h("#"+a+"の取得ができませんでした");var n=e.getElementsByClassName(d);if(null===n)throw new h("."+d+"の取得ができませんでした");var o=document.getElementById(u);if(null===o)throw new h("#"+u+"の取得ができませんでした");this.globalNav=e,this.globalNavContainer=t,this.globalNavClips=n,this.globalNavOpener=o,this.modalShadow=this.createModalShadowElement(),document.body.appendChild(this.modalShadow),i&&this.appendSwipeValidationEvent()}var h=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(t);v.prototype.openSlideNavMenu=function(){this.pinBodyScroll(),this.globalNavContainer.classList.add(e),this.modalShadow.classList.add(n)},v.prototype.closeSlideNavMenu=function(){this.unpinBodyScroll(),-1!==this.globalNavContainer.className.indexOf(e)&&this.globalNavContainer.classList.remove(e),this.modalShadow.classList.remove(n)},v.prototype.pinBodyScroll=function(){this.states.scrollY=window.scrollY,document.body.style.position="fixed",document.body.style.top="-"+this.states.scrollY+"px"},v.prototype.unpinBodyScroll=function(){document.body.style.position="",document.body.style.top="",0!==this.states.scrollY&&window.scrollTo(0,this.states.scrollY)},v.prototype.openDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=function(t){for(var e=0,n=t.children.length,o=0;o<n;o++){var i=t.children[o];if(i instanceof HTMLElement){var l=i.scrollHeight,a=i.offsetHeight;e+=a<l?l:a}}return e}(t)+"px"),t.classList.add(e)},v.prototype.closeDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=""),t.classList.remove(e)},v.prototype.closeDropDownClipAll=function(){for(var t=this.globalNavClips.length,e=0;e<t;e++){var n=this.globalNavClips[e];this.closeDropDownClip(n)}},v.prototype.clickEventHandler=function(t){-1===t.className.indexOf(e)?(this.closeDropDownClipAll(),this.openDropDownClip(t)):this.closeDropDownClip(t)},v.prototype.isOtherElementsClick=function(t,e){if(null===t.target)return!0;if(!(t.target instanceof Element))return!0;for(var i=function(t,e){var n=t.tagName.toUpperCase(),o=e.toUpperCase();return n===o?t:n!==o&&null!==t.parentElement?i(t.parentElement,o):t},n=i(t.target,"div").className,o=e.length,l=0;l<o;l++)if(-1!==n.indexOf(e[l]))return!1;return!0},v.prototype.isCloseElementClick=function(t){var e=!1;return t.target instanceof HTMLElement&&-1!==t.target.className.indexOf(p)&&(e=!0),e},v.prototype.createModalShadowElement=function(){var t=document.createElement("div");return t.classList.add("modal_shadow"),t},v.prototype.appendSwipeValidationEvent=function(){var t=this;i&&(window.addEventListener("touchstart",function(){t.states.isSwiping=!1}),window.addEventListener("touchmove",function(){t.states.isSwiping||(t.states.isSwiping=!0)}))},document.addEventListener("DOMContentLoaded",function(){var n=new v;document.addEventListener(s,function(t){if(!n.states.isSwiping){var e=[d,"global_nav_clip_wrapper"];n.isOtherElementsClick(t,e)&&n.closeDropDownClipAll()}},!1);for(var t=n.globalNavClips.length,e=function(t){var e=n.globalNavClips[t];e.addEventListener(s,function(t){n.states.isSwiping||t.target instanceof HTMLElement&&-1!==t.target.className.indexOf("is_unclose_global_nav_clip")||n.clickEventHandler(e)},!1)},o=0;o<t;o++)e(o);n.globalNavOpener.addEventListener(s,function(){n.states.isSwiping||n.openSlideNavMenu()},!1);function i(){n.states.isSwiping||n.closeSlideNavMenu()}n.modalShadow.addEventListener(s,i,!1);for(var l=n.globalNavCloseElements.length,a=0;a<l;a++){n.globalNavCloseElements[a].addEventListener(s,i,!1)}!function(t){var e=document.createElement("button");e.type="button",e.className="fixed_global_nav_opener fixed_button pc_view_hidden",e.id="fixedGlobalNavOpener",e.title=r;var n=c();e.appendChild(n),e.addEventListener(s,function(){return t()}),document.body.appendChild(e)}(n.openSlideNavMenu.bind(n))})}();

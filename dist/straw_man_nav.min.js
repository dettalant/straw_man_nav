/*!
 *   straw_man_nav.js
 * See {@link https://github.com/dettalant/straw_man_nav}
 *
 * @author dettalant
 * @version v0.2.6
 * @license MIT License
 */
!function(){"use strict";function t(t){this.message=t,this.name="NavManagerError"}var i="globalNavContainer",l="globalNav",a="global_nav_clip",s="globalNavOpener",e="is_opened",n="is_visible",r=null===window.ontouchstart,c=null===window.ontouchend?"touchend":"click";t.prototype.toString=function(){return this.name+": "+this.message};function p(){this.states={isSwiping:!1,scrollY:0};var t=document.getElementById(i);if(null===t)throw new d("#"+i+"の取得ができませんでした");var e=document.getElementById(l);if(null===e)throw new d("#"+l+"の取得ができませんでした");var n=e.getElementsByClassName(a);if(null===n)throw new d("."+a+"の取得ができませんでした");var o=document.getElementById(s);if(null===o)throw new d("#"+s+"の取得ができませんでした");this.globalNav=e,this.globalNavContainer=t,this.globalNavClips=n,this.globalNavOpener=o,this.modalShadow=this.createModalShadowElement(),document.body.appendChild(this.modalShadow),r&&this.appendSwipeValidationEvent()}var d=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(t);p.prototype.openSlideNavMenu=function(){this.pinBodyScroll(),this.globalNavContainer.classList.add(e),this.modalShadow.classList.add(n)},p.prototype.closeSlideNavMenu=function(){this.unpinBodyScroll(),-1!==this.globalNavContainer.className.indexOf(e)&&this.globalNavContainer.classList.remove(e),this.modalShadow.classList.remove(n)},p.prototype.pinBodyScroll=function(){this.states.scrollY=window.scrollY,document.body.style.position="fixed",document.body.style.top="-"+this.states.scrollY+"px"},p.prototype.unpinBodyScroll=function(){document.body.style.position="",document.body.style.top="",0!==this.states.scrollY&&window.scrollTo(0,this.states.scrollY)},p.prototype.openDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=function(t){for(var e=0,n=t.children.length,o=0;o<n;o++){var i=t.children[o];if(i instanceof HTMLElement){var l=i.scrollHeight,a=i.offsetHeight;e+=a<l?l:a}}return e}(t)+"px"),t.classList.add(e)},p.prototype.closeDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=""),t.classList.remove(e)},p.prototype.closeDropDownClipAll=function(){for(var t=this.globalNavClips.length,e=0;e<t;e++){var n=this.globalNavClips[e];this.closeDropDownClip(n)}},p.prototype.clickEventHandler=function(t){-1===t.className.indexOf(e)?(this.closeDropDownClipAll(),this.openDropDownClip(t)):this.closeDropDownClip(t)},p.prototype.isOtherElementsClick=function(t,e){if(null===t.target)return!0;if(!(t.target instanceof Element))return!0;for(var i=function(t,e){var n=t.tagName.toUpperCase(),o=e.toUpperCase();return n===o?t:n!==o&&null!==t.parentElement?i(t.parentElement,o):t},n=i(t.target,"div").className,o=e.length,l=0;l<o;l++)if(-1!==n.indexOf(e[l]))return!1;return!0},p.prototype.createModalShadowElement=function(){var t=document.createElement("div");return t.classList.add("modal_shadow"),t},p.prototype.appendSwipeValidationEvent=function(){var t=this;r&&(window.addEventListener("touchstart",function(){t.states.isSwiping=!1}),window.addEventListener("touchmove",function(){t.states.isSwiping||(t.states.isSwiping=!0)}))},document.addEventListener("DOMContentLoaded",function(){var n=new p;document.addEventListener(c,function(t){if(!n.states.isSwiping){var e=[a,"global_nav_clip_wrapper"];n.isOtherElementsClick(t,e)&&n.closeDropDownClipAll()}},!1);for(var t=n.globalNavClips.length,e=function(t){var e=n.globalNavClips[t];e.addEventListener(c,function(){n.states.isSwiping||n.clickEventHandler(e)},!1)},o=0;o<t;o++)e(o);n.globalNavOpener.addEventListener(c,function(){n.states.isSwiping||n.openSlideNavMenu()},!1),n.modalShadow.addEventListener(c,function(){n.states.isSwiping||n.closeSlideNavMenu()},!1)})}();

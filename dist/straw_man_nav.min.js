/*!
 *   straw_man_nav.js
 * See {@link https://github.com/dettalant/straw_man_nav}
 *
 * @author dettalant
 * @version v0.3.0
 * @license MIT License
 */
!function(){"use strict";function t(t){this.message=t,this.name="NavManagerError"}var i=null===window.ontouchstart,l=i?"touchend":"click",a="メニューを開く",s=function(){var t="http://www.w3.org/2000/svg",e=document.createElementNS(t,"svg");e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("class","svg_icon icon_menu"),e.setAttribute("role","img");var n=document.createElementNS(t,"title");n.textContent=a,e.appendChild(n);var o=document.createElementNS(t,"path");return o.setAttribute("class","svg_main_color"),o.setAttribute("d","M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"),e.appendChild(o),e},r="globalNavContainer",c="globalNav",d="global_nav_clip",p="globalNavOpener",e="is_opened",n="is_visible";t.prototype.toString=function(){return this.name+": "+this.message};function u(){this.states={isSwiping:!1,scrollY:0};var t=document.getElementById(r);if(null===t)throw new v("#"+r+"の取得ができませんでした");var e=document.getElementById(c);if(null===e)throw new v("#"+c+"の取得ができませんでした");var n=e.getElementsByClassName(d);if(null===n)throw new v("."+d+"の取得ができませんでした");var o=document.getElementById(p);if(null===o)throw new v("#"+p+"の取得ができませんでした");this.globalNav=e,this.globalNavContainer=t,this.globalNavClips=n,this.globalNavOpener=o,this.modalShadow=this.createModalShadowElement(),document.body.appendChild(this.modalShadow),i&&this.appendSwipeValidationEvent()}var v=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(t);u.prototype.openSlideNavMenu=function(){this.pinBodyScroll(),this.globalNavContainer.classList.add(e),this.modalShadow.classList.add(n)},u.prototype.closeSlideNavMenu=function(){this.unpinBodyScroll(),-1!==this.globalNavContainer.className.indexOf(e)&&this.globalNavContainer.classList.remove(e),this.modalShadow.classList.remove(n)},u.prototype.pinBodyScroll=function(){this.states.scrollY=window.scrollY,document.body.style.position="fixed",document.body.style.top="-"+this.states.scrollY+"px"},u.prototype.unpinBodyScroll=function(){document.body.style.position="",document.body.style.top="",0!==this.states.scrollY&&window.scrollTo(0,this.states.scrollY)},u.prototype.openDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=function(t){for(var e=0,n=t.children.length,o=0;o<n;o++){var i=t.children[o];if(i instanceof HTMLElement){var l=i.scrollHeight,a=i.offsetHeight;e+=a<l?l:a}}return e}(t)+"px"),t.classList.add(e)},u.prototype.closeDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=""),t.classList.remove(e)},u.prototype.closeDropDownClipAll=function(){for(var t=this.globalNavClips.length,e=0;e<t;e++){var n=this.globalNavClips[e];this.closeDropDownClip(n)}},u.prototype.clickEventHandler=function(t){-1===t.className.indexOf(e)?(this.closeDropDownClipAll(),this.openDropDownClip(t)):this.closeDropDownClip(t)},u.prototype.isOtherElementsClick=function(t,e){if(null===t.target)return!0;if(!(t.target instanceof Element))return!0;for(var i=function(t,e){var n=t.tagName.toUpperCase(),o=e.toUpperCase();return n===o?t:n!==o&&null!==t.parentElement?i(t.parentElement,o):t},n=i(t.target,"div").className,o=e.length,l=0;l<o;l++)if(-1!==n.indexOf(e[l]))return!1;return!0},u.prototype.createModalShadowElement=function(){var t=document.createElement("div");return t.classList.add("modal_shadow"),t},u.prototype.appendSwipeValidationEvent=function(){var t=this;i&&(window.addEventListener("touchstart",function(){t.states.isSwiping=!1}),window.addEventListener("touchmove",function(){t.states.isSwiping||(t.states.isSwiping=!0)}))},document.addEventListener("DOMContentLoaded",function(){var n=new u;document.addEventListener(l,function(t){if(!n.states.isSwiping){var e=[d,"global_nav_clip_wrapper"];n.isOtherElementsClick(t,e)&&n.closeDropDownClipAll()}},!1);for(var t=n.globalNavClips.length,e=function(t){var e=n.globalNavClips[t];e.addEventListener(l,function(){n.states.isSwiping||n.clickEventHandler(e)},!1)},o=0;o<t;o++)e(o);n.globalNavOpener.addEventListener(l,function(){n.states.isSwiping||n.openSlideNavMenu()},!1),n.modalShadow.addEventListener(l,function(){n.states.isSwiping||n.closeSlideNavMenu()},!1),function(t){var e=document.createElement("button");e.type="button",e.className="fixed_global_nav_opener fixed_button pc_view_hidden",e.id="fixedGlobalNavOpener",e.title=a;var n=s();e.appendChild(n),e.addEventListener(l,function(){return t()}),document.body.appendChild(e)}(n.openSlideNavMenu.bind(n))})}();

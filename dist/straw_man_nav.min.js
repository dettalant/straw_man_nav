/*!
 *   straw_man_nav.js
 * See {@link https://github.com/dettalant/straw_man_nav}
 *
 * @author dettalant
 * @version v0.4.0
 * @license MIT License
 */
var strawManNav=function(){"use strict";function t(t){this.message=t,this.name="NavManagerError"}var i=null===window.ontouchstart,l=i?"touchend":"click";t.prototype.toString=function(){return this.name+": "+this.message};function e(t){this.states={isSwiping:!1,scrollY:0},this.args=t||{navContainerId:"globalNavContainer",navId:"globalNav",navClipClassName:"global_nav_clip",navClipWrapperClassName:"global_nav_clip_wrapper",navCloseElClassName:"is_close_global_nav",navClipUncloseElClassName:"is_unclose_global_nav_clip",navOpenerId:"globalNavOpener",stateOpened:"is_opened",stateVisible:"is_visible"},this.globalNavCloseElements=document.getElementsByClassName(this.args.navCloseElClassName);var e=document.getElementById(this.args.navContainerId);if(null===e)throw new o("#"+this.args.navContainerId+"の取得ができませんでした");var s=document.getElementById(this.args.navId);if(null===s)throw new o("#"+this.args.navId+"の取得ができませんでした");var n=s.getElementsByClassName(this.args.navClipClassName);if(null===n)throw new o("."+this.args.navClipClassName+"の取得ができませんでした");var a=document.getElementById(this.args.navOpenerId);if(null===a)throw new o("#"+this.args.navOpenerId+"の取得ができませんでした");this.globalNav=s,this.globalNavContainer=e,this.globalNavClips=n,this.globalNavOpener=a,this.modalShadow=this.createModalShadowElement(),document.body.appendChild(this.modalShadow),i&&this.appendSwipeValidationEvent()}var o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(t);return e.prototype.openSlideNavMenu=function(){this.pinBodyScroll(),this.globalNavContainer.classList.add(this.args.stateOpened),this.modalShadow.classList.add(this.args.stateVisible)},e.prototype.closeSlideNavMenu=function(){this.unpinBodyScroll(),-1!==this.globalNavContainer.className.indexOf(this.args.stateOpened)&&this.globalNavContainer.classList.remove(this.args.stateOpened),this.modalShadow.classList.remove(this.args.stateVisible)},e.prototype.pinBodyScroll=function(){this.states.scrollY=window.scrollY,document.body.style.position="fixed",document.body.style.top="-"+this.states.scrollY+"px"},e.prototype.unpinBodyScroll=function(){document.body.style.position="",document.body.style.top="",0!==this.states.scrollY&&window.scrollTo(0,this.states.scrollY)},e.prototype.openDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=function(t){for(var e=0,s=t.children.length,n=0;n<s;n++){var a=t.children[n];if(a instanceof HTMLElement){var i=a.scrollHeight,o=a.offsetHeight;e+=o<i?i:o}}return e}(t)+"px"),t.classList.add(this.args.stateOpened)},e.prototype.closeDropDownClip=function(t){t instanceof HTMLElement&&(t.style.maxHeight=""),t.classList.remove(this.args.stateOpened)},e.prototype.closeDropDownClipAll=function(){for(var t=this.globalNavClips.length,e=0;e<t;e++){var s=this.globalNavClips[e];this.closeDropDownClip(s)}},e.prototype.clickEventHandler=function(t){-1===t.className.indexOf(this.args.stateOpened)?(this.closeDropDownClipAll(),this.openDropDownClip(t)):this.closeDropDownClip(t)},e.prototype.isOtherElementsClick=function(t,e){if(null===t.target)return!0;if(!(t.target instanceof Element))return!0;for(var a=function(t,e){var s=t.tagName.toUpperCase(),n=e.toUpperCase();return s===n?t:s!==n&&null!==t.parentElement?a(t.parentElement,n):t},s=a(t.target,"div").className,n=e.length,i=0;i<n;i++)if(-1!==s.indexOf(e[i]))return!1;return!0},e.prototype.isCloseElementClick=function(t){var e=!1;return t.target instanceof HTMLElement&&-1!==t.target.className.indexOf(this.args.navCloseElClassName)&&(e=!0),e},e.prototype.createModalShadowElement=function(){var t=document.createElement("div");return t.classList.add("modal_shadow"),t},e.prototype.appendSwipeValidationEvent=function(){var t=this;i&&(window.addEventListener("touchstart",function(){t.states.isSwiping=!1}),window.addEventListener("touchmove",function(){t.states.isSwiping||(t.states.isSwiping=!0)}))},e.prototype.registerNavEvents=function(){var s=this;document.addEventListener(l,function(t){if(!s.states.isSwiping){var e=[s.args.navClipClassName,s.args.navClipWrapperClassName];s.isOtherElementsClick(t,e)&&s.closeDropDownClipAll()}},!1);for(var t=this.globalNavClips.length,e=function(t){var e=s.globalNavClips[t];e.addEventListener(l,function(t){s.states.isSwiping||t.target instanceof HTMLElement&&-1!==t.target.className.indexOf(s.args.navClipUncloseElClassName)||s.clickEventHandler(e)},!1)},n=0;n<t;n++)e(n);this.globalNavOpener.addEventListener(l,function(){s.states.isSwiping||s.openSlideNavMenu()},!1);function a(){s.states.isSwiping||s.closeSlideNavMenu()}this.modalShadow.addEventListener(l,a,!1);for(var i=this.globalNavCloseElements.length,o=0;o<i;o++){this.globalNavCloseElements[o].addEventListener(l,a,!1)}},e}();
